
# Chapter 12: Email Investigations - Revision Notes

## Part 1: Core Concepts & Terminology (核心概念与术语)

This section covers the foundational knowledge required for email investigations.

### Key Roles

*   **Email Client (邮件客户端):** Software used by the end-user to read, write, and manage emails.
    *   ***Examples:*** `Microsoft Outlook`, `Eudora`, `Thunderbird`.
    *   ***Exam Tip:*** This is a primary source of **direct evidence**. Look for local storage files like `.pst` or `.ost` on the user's machine.

*   **Email Server (邮件服务器):** A server that handles and delivers email over the internet. It sends, receives, and stores emails.
    *   ***Examples:*** `Microsoft Exchange`, `Sendmail` (Unix/Linux).
    *   ***Exam Tip:*** **Server Logs** are the most critical evidence for tracing an email's origin.

### Key Protocols (关键协议)

| Protocol | Full Name                               | Function                                                              | Port | Forensic Significance                                                              |
| :------- | :-------------------------------------- | :-------------------------------------------------------------------- | :--- | :--------------------------------------------------------------------------------- |
| **SMTP** | Simple Mail Transfer Protocol           | **Sending (发送)** emails from client to server and between servers.  | 25   | Essential for understanding the outbound path of an email.                         |
| **POP3** | Post Office Protocol 3                  | **Receiving (接收)** emails. Downloads email to the client and **deletes it from the server**. | 110  | Evidence may be missing from the server. The investigator **must** check the client machine. |
| **IMAP** | Internet Message Access Protocol        | **Accessing (访问)** emails. Manages emails directly on the server; a copy **remains on the server**. | 143  | More favorable for investigation as emails are preserved on the server.            |

---

## Part 2: The Email Investigation Process (电子邮件调查流程)

This is a critical topic, often appearing as a short-answer or essay question.

### Broad Steps in Email Forensics

1.  **Obtain a Search Warrant (获取搜查令):** Ensure all actions are legally sound.
2.  **Examine Email Headers (检查邮件头):** **THE TECHNICAL CORE.** Headers contain the routing information (path) of the email.
3.  **Trace Email Origin (追踪邮件源头):** Use header information to find the sender's true IP address.
4.  **Acquire and Analyze Evidence (获取并分析证据):** Collect email content, attachments, client files (`.pst`/`.ost`), and server logs.
5.  **Recover Deleted Emails (恢复已删除邮件):** Use forensic tools to recover emails that have been deleted.
6.  **Present Findings (提交报告):** Document all findings in a clear, concise forensic report.

---

## Part 3: Deep Dive - Analyzing Email Headers (深入解析 - 分析邮件头)

**This is a guaranteed exam topic.** You will likely be given a sample header and asked to analyze it.

An email consists of three parts: **Header (头)**, **Body (正文)**, and **Signature (签名)**. The header is the most important for forensics.

### Key Header Fields & Their Meanings

*   `From:`: The displayed sender. **Can be easily spoofed.** Not reliable.
*   `Return-Path` / `Reply-To`: The address for replies. Also **can be spoofed**.
*   `Received:`: **THE MOST IMPORTANT FIELD.** A new `Received` line is added every time the email passes through a mail server.
    *   **How to Read:** Read from **bottom to top** to trace the email's path from origin to destination.
    *   **What it Contains:**
        *   The IP address of the sending server.
        *   The hostname of the receiving server.
        *   A precise timestamp.
        *   The protocol used (e.g., ESMTP).
*   `Message-ID:`: A unique ID generated by the mail server. Useful for correlating with server logs.
*   `X-Originating-IP` or `X-Sender-IP`: A non-standard but highly valuable field added by some webmail providers (like older Hotmail/Yahoo versions) that explicitly states the **public IP address of the sender's client machine**.

### How to Answer a Header Analysis Question

1.  **State Your Goal:** "My objective is to trace the origin of this email by analyzing its header."
2.  **Start from the Bottom:** "The trace begins with the bottom-most `Received` header. The email originated from a server with the IP address `[IP Address]` at `[Time]`."
3.  **Follow the Path Upwards:** "It was then relayed to the next server, `[Next Server Name]`, and so on."
4.  **Identify the Originating IP:** "The most probable originating IP of the sender is `[IP Address]`, which was found in the first `Received` header (at the bottom) or an `X-Originating-IP` field."
5.  **Acknowledge Spoofing:** "While the `From:` address indicates `[sender@example.com]`, this is unreliable as it can be spoofed. The IP path provides a more trustworthy trail."

---

## Part 4: Common Email Crimes & Evidence Locations

### Types of Email Crimes

*   **Email Spoofing (邮件伪造):** Falsifying the sender address to impersonate someone else.
*   **Phishing (网络钓鱼):** Sending fraudulent emails to trick users into revealing sensitive information (credentials, credit card numbers).
*   **Email Spamming (垃圾邮件):** Sending unsolicited bulk messages.
*   **Mail Bombing (邮件炸弹):** Sending a massive volume of emails to a single address to cause a Denial-of-Service (DoS) attack.

### Where to Find Evidence

*   **Client-Side (客户端):**
    *   `*.pst`, `*.ost` (Outlook): Contains emails, calendars, contacts.
    *   **Browser Cache:** For webmail services like Gmail, the cache may hold copies of the email pages.
*   **Server-Side (服务器端):**
    *   **Transaction Logs:** Record all email activity. This is the most crucial server-side evidence.
    *   **Firewall/Router Logs:** Contain records of network connections (source/destination IPs) that can corroborate the IP addresses found in email headers.
    *   **UNIX/Linux Systems:** Logs are often in `/var/log/maillog`.
    *   **Microsoft Exchange:** Uses `.edb` database files and `.log` transaction log files.

---
## Part 5: Specialized Forensic Tools

As mentioned in the lecture, specialized tools simplify the process.

*   **Function:** These tools can automatically parse email files, recover deleted items, and present the data in a readable format.
*   **Examples:**
    *   **AccessData's Forensic Toolkit (FTK):** Can index and search email data, filter by client/server, and recover emails from Outlook files.
    *   **EnCase, FINALeMAIL, Paraben E-Mail Examiner:** Other popular commercial tools.
*   **Advantage:** The investigator does not need to be an expert on how every email server and client works internally. The tool handles the complexity.
